import{H as h}from"./Highlight-wkXLIbi7.js";import{V as d}from"./VideoNotFoundError-Cuq1j19V.js";import{A as c}from"./ApplicationError-C71rmzjz.js";import{c as g}from"./id-generator-CM2YM-lZ.js";import"./index-cBR94Rst.js";class s extends c{constructor(){super("Highlight name cannot be empty","INVALID_HIGHLIGHT_NAME"),Object.setPrototypeOf(this,s.prototype)}}class v{constructor(t,r,i){this.highlightRepository=t,this.videoRepository=r,this.transcriptRepository=i}async execute(t){if(this.validateInput(t),!await this.videoRepository.findById(t.videoId))throw new d(t.videoId);const i=g(),o=new h(i,t.videoId,t.name);if(t.useAISuggestions){const a=await this.transcriptRepository.findByVideoId(t.videoId);if(a){const n=a.sections.flatMap(e=>e.sentences).filter(e=>e.isHighlightSuggestion).map(e=>e.id);for(const e of n)o.addSentence(e)}}return await this.highlightRepository.save(o),o}validateInput(t){if(!t.name||t.name.trim()==="")throw new s}}export{v as CreateHighlightUseCase};
