class o{static validate(t){let i;try{const e=JSON.parse(t);if(typeof e!="object"||e===null)throw new Error("JSON 格式錯誤:根節點必須是物件");i=e}catch{throw new Error("JSON 格式錯誤:無法解析 JSON 字串")}if(!i.sections||!Array.isArray(i.sections))throw new Error('JSON 格式錯誤:缺少必要欄位 "sections"');if(i.sections.length===0)throw new Error('JSON 格式錯誤:"sections" 不可為空陣列');for(let e=0;e<i.sections.length;e++){const n=i.sections[e];if(!n.id)throw new Error(`JSON 格式錯誤:sections[${e}] 缺少必要欄位 "id"`);if(!n.title)throw new Error(`JSON 格式錯誤:sections[${e}] 缺少必要欄位 "title"`);if(!n.sentences||!Array.isArray(n.sentences))throw new Error(`JSON 格式錯誤:sections[${e}] 缺少必要欄位 "sentences"`);if(n.sentences.length===0)throw new Error(`JSON 格式錯誤:sections[${e}].sentences 不可為空陣列`);for(let r=0;r<n.sentences.length;r++){const s=n.sentences[r];if(!s.id)throw new Error(`JSON 格式錯誤:sections[${e}].sentences[${r}] 缺少必要欄位 "id"`);if(!s.text||typeof s.text!="string")throw new Error(`JSON 格式錯誤:sections[${e}].sentences[${r}] 缺少必要欄位 "text"`);if(typeof s.startTime!="number")throw new Error(`JSON 格式錯誤:sections[${e}].sentences[${r}] 缺少必要欄位 "startTime"`);if(typeof s.endTime!="number")throw new Error(`JSON 格式錯誤:sections[${e}].sentences[${r}] 缺少必要欄位 "endTime"`);if(s.endTime<=s.startTime&&console.warn(`時間戳異常:sections[${e}].sentences[${r}] 的 endTime (${s.endTime}) 小於或等於 startTime (${s.startTime})`),s.startTime<0&&console.warn(`時間戳異常:sections[${e}].sentences[${r}] 的 startTime (${s.startTime}) 為負數`),r<n.sentences.length-1){const a=n.sentences[r+1];s.endTime>a.startTime&&console.warn(`時間戳重疊:sections[${e}].sentences[${r}] 的 endTime (${s.endTime}) 晚於下一句的 startTime (${a.startTime})`)}}}return i}static fillDefaults(t){t.fullText||(t.fullText=t.sections.flatMap(i=>i.sentences.map(e=>e.text)).join(" "));for(const i of t.sections)for(const e of i.sentences)e.isHighlightSuggestion===void 0&&(e.isHighlightSuggestion=!1);return t}}class l{mockDataMap=new Map;setMockData(t,i){const e=o.validate(i),n=o.fillDefaults(e);this.mockDataMap.set(t,JSON.stringify(n))}async generate(t){const i=this.mockDataMap.get(t)||this.getDefaultMockData(),e=o.validate(i),n=o.fillDefaults(e);await this.delay(1500);const r={videoId:t,fullText:n.fullText,sections:n.sections.map(s=>({id:s.id,title:s.title,sentences:s.sentences.map(a=>({id:a.id,text:a.text,startTime:a.startTime,endTime:a.endTime,isHighlightSuggestion:a.isHighlightSuggestion??!1}))}))};return this.mockDataMap.delete(t),r}delay(t){return new Promise(i=>setTimeout(i,t))}hasMockData(t){return this.mockDataMap.has(t)}getDefaultMockData(){return JSON.stringify({fullText:"大家好，歡迎來到今天的分享。今天我們要討論前端架構設計的經驗。我們會討論 Clean Architecture 在前端的應用。Clean Architecture 是由 Robert Martin 提出的軟體架構模式。核心理念是讓業務邏輯獨立於框架和外部依賴。這種架構分為四層：Domain、Application、Infrastructure、Presentation。Domain Layer 包含業務實體和規則，完全不依賴外部。Application Layer 定義應用邏輯和 Use Case。Infrastructure Layer 處理外部系統整合。Presentation Layer 負責使用者介面。",sections:[{id:"section_1",title:"開場介紹",sentences:[{id:"sentence_1",text:"大家好，歡迎來到今天的分享。",startTime:0,endTime:3.5,isHighlightSuggestion:!0},{id:"sentence_2",text:"今天我們要討論前端架構設計的經驗。",startTime:3.5,endTime:7.2,isHighlightSuggestion:!0},{id:"sentence_3",text:"我們會討論 Clean Architecture 在前端的應用。",startTime:7.2,endTime:11.5,isHighlightSuggestion:!1}]},{id:"section_2",title:"Clean Architecture 介紹",sentences:[{id:"sentence_4",text:"Clean Architecture 是由 Robert Martin 提出的軟體架構模式。",startTime:11.5,endTime:17,isHighlightSuggestion:!1},{id:"sentence_5",text:"核心理念是讓業務邏輯獨立於框架和外部依賴。",startTime:17,endTime:21.5,isHighlightSuggestion:!0},{id:"sentence_6",text:"這種架構分為四層：Domain、Application、Infrastructure、Presentation。",startTime:21.5,endTime:27.8,isHighlightSuggestion:!1}]},{id:"section_3",title:"各層職責",sentences:[{id:"sentence_7",text:"Domain Layer 包含業務實體和規則，完全不依賴外部。",startTime:27.8,endTime:32.5,isHighlightSuggestion:!0},{id:"sentence_8",text:"Application Layer 定義應用邏輯和 Use Case。",startTime:32.5,endTime:36.8,isHighlightSuggestion:!1},{id:"sentence_9",text:"Infrastructure Layer 處理外部系統整合。",startTime:36.8,endTime:40.5,isHighlightSuggestion:!0},{id:"sentence_10",text:"Presentation Layer 負責使用者介面。",startTime:40.5,endTime:44,isHighlightSuggestion:!1}]}]})}}export{l as MockAIService};
